# Firebringer - Claude Code 工作规范

## 文档同步规范

### 1. 根文档更新联动

**规则**: 任何功能、架构、写法更新，必须在工作结束后更新相关目录的子文档。

**执行**:
- 修改 `PRD.md` 某章节后，检查是否需要同步更新对应的技术文档
- 修改架构后，更新 `docs/architecture/` 下的相关文件
- 修改 API 后，更新 `docs/api/` 下的接口文档

---

### 2. 文件夹 README 规范

每个文件夹需包含 `README.md`（3行架构说明 + 文件清单）：

```markdown
# [文件夹名]

[第1行: 架构定位 - 在系统中的角色]
[第2行: 核心职责 - 负责什么]
[第3行: 依赖关系 - 上游/下游]

> 一旦本文件夹有所变化，请更新本文档。

## 文件清单

| 文件 | 地位 | 功能 |
|------|------|------|
| `xxx.ts` | 核心/辅助/工具 | 简短描述 |
```

---

### 3. 文件头注释规范

每个 `.ts` / `.tsx` / `.go` 文件开头必须包含：

```typescript
/**
 * Input: 依赖外部什么（引用其他文件的 pos）
 * Output: 对外提供什么
 * Pos: 在系统局部的地位
 *
 * 一旦本文件被更新，务必更新：
 * 1. 本注释块
 * 2. 所属文件夹的 README.md
 */
```

**示例**:

```typescript
/**
 * Input: ReactFlow 的 [node, edge] 数据，types.ts 的 NodeType 定义
 * Output: 渲染后的无限画布组件，节点选中事件回调
 * Pos: 画布编辑器的核心视图组件，连接数据层与UI层
 *
 * 一旦本文件被更新，务必更新：
 * 1. 本注释块
 * 2. frontend/src/components/canvas/README.md
 */
```

---

### 4. 语义链接规范

在 `Input` 中引用其他文件的 `pos` 描述，形成语义链接网络：

```typescript
/**
 * Input:
 *   - API_CONFIG 的 [Pos: 全局API配置管理中心]
 *   - useNodeState 的 [Pos: 节点状态管理Hook]
 * Output: 初始化后的API客户端实例
 * Pos: API调用的统一入口层
 */
```

**引用格式**: `文件名/模块名 的 [Pos: 描述]`

---

## 开发流程提醒

当 Claude Code 执行以下操作时，自动触发检查：
- `Edit` / `Write` 操作后：检查文件头注释是否需要更新
- 创建新文件后：提示创建文件夹 README.md
- 修改架构后：提示更新 PRD.md 和相关文档

---

## 模板速查

### 文件夹 README 模板

```markdown
# [FolderName]

[架构定位]

[核心职责]

[依赖关系: 上游 → 本模块 → 下游]

> 一旦本文件夹有所变化，请更新本文档。

## 文件清单

| 文件 | 地位 | 功能 |
|------|------|------|
```

### 文件头注释模板

```typescript
/**
 * Input: [依赖列表，引用其他文件的 pos]
 * Output: [对外输出]
 * Pos: [在系统中的地位]
 *
 * 一旦本文件被更新，务必更新：
 * 1. 本注释块
 * 2. 所属文件夹的 README.md
 */
```
