# Firebringer - AI Workflow for Professional Filmmakers
## Product Requirements Document (PRD)

**Version**: v2.3
**Date**: 2026-01-02
**Code Name**: Firebringer
**Status**: 可执行版本 (Executive Version)

**重大更新 (v2.3 - 终极无歧义版)**:
- **商业化标注显式化**: 第 7 章积分/充值/订阅/成本/定价章节全部标注 Phase 4+，与 BYOK 模式完全分离
- **模型范围清晰化**: 模型分类表标注"路线图规划"，明确 Phase 1 仅 3 个首发模型
- **风险责任人明确化**: 所有 TBD 占位符替换为"开源团队"，消除歧义
- **术语统一性确认**: 全文无"本地保存服务"残留，无"127.0.0.1"混淆引用
- **协作功能 Phase 4 化**: WebSocket/CRDT/实时协作相关描述均已标注未来规划

**历史版本 (v2.2 - 正式版)**:
- **架构形态**: Wails 桌面应用 (Desktop-Only)，完全移除 Web 版本规划
- **商业模式**: BYOK (Bring Your Own Key)，用户自带 API Key，平台零费用（MVP）
- **模型集成**: 首发 3 个模型（GPT-4o + Nano Banana + Veo 3），路线图规划 50+ 模型
- **功能定位**: 单机版 MVP，协作/市场/积分系统移至 Phase 4
- **技术承诺**: "实时预览" → "异步进度追踪"，"角色同步" → "本地角色预设"
- **时间规划**: Phase 1 (4周) → Phase 2 (6周) → Phase 3 (8周) → Phase 4 (未来)
- **存储架构**: Wails + SQLite + 本地文件
- **输出规格明确**: 补充图像/视频/关键帧的默认分辨率、比例、文件上限
- **离线/在线分离**: 明确标注编辑离线可用、生成需联网

**历史版本**:
- v2.1: 终极版，修正即时反馈、统一存储架构、补充输出规格
- v2.0: 单机桌面版重大重构
- v1.5: 技术架构细化、模型路线图、本地保存服务、协作角色权限
- v1.4: 全球市场定位，TVC/影视创作者聚焦
- v1.3: 商业模式（双轨制、积分系统、定价策略）
- v1.2: 用户场景、节点类型、性能优化、对话侧栏
- v1.1: 提示词库、角色库、关键帧提取

---

## 1. 产品概述

### 1.1 产品定位
Firebringer 是一个**单机桌面版 AI 工作流编辑器**，基于 Wails 框架构建，通过无限画布和节点式设计，让创作者完全掌控 AI 创作过程。

**核心特性**:
- **桌面应用** (Desktop-Only): Wails + React 原生桌面体验，支持 Windows/macOS/Linux
- **BYOK 模式**: 用户自带 API Key 直接调用模型，Firebringer 平台零费用
- **本地优先**: 所有项目数据、历史记录、角色预设存储在本地
- **网络依赖**: AI 生成功能需要公网连接调用第三方模型 API (OpenAI, Runway, Kling 等)
- **单机版**: 无协作功能、无云端同步、无市场社区 (未来 Phase 4 规划)

我们不只是一个"AI 生成工具"——我们是创作者的 **AI 控制台**。在这里，AI 是你的创作助手，而不是黑盒。每一个生成参数、每一次迭代、每一条创作路径，都在你的掌控之中。

### 1.2 目标用户
- **TVC广告团队**: 广告导演、制作公司、创意代理商
- **影视从业者**: 独立导演、cinematographer、视效总监
- **动画工作室**: 动画导演、分镜师、概念设计师
- **品牌创意团队**: 品牌方创意总监、内容营销负责人

### 1.3 核心价值主张

#### 可控性 (Control)
- **完全透明的生成参数**: 每个AI节点的参数都可精细调整
- **非线性工作流**: 随时回溯、修改、替换任意节点
- **版本对比**: 并行运行多个方案，直观对比结果
- **可复用的工作流**: 保存成功的创作路径，一键复用

#### 心流体验 (Flow)
- **沉浸式无限画布**: 无干扰的创作空间，让创作者进入状态
- **过程可见**: 每个节点的生成进度实时更新，长耗时任务显示进度条，完成后通知
- **键盘优先**: 高效的快捷键系统，不中断创作思路
- **视觉化思考**: 在画布上"画"出创作逻辑，而非填写表单

#### 专业级输出 (Professional)
- **电影级质量**: 集成 Sora、Runway Gen-3 等顶级视频模型
- **工作流可交付**: 导出标准化的工作流 JSON 文件，支持本地备份和恢复
- **从分镜到成片**: 覆盖前期创意到后期生成的全链路

---

### 1.4 用户场景

#### 场景1: 影像创作者快速生成分镜

**参与者**: 导演 / 分镜师

**前置条件**: 有参考图或分镜描述文本

**操作流程**:
1. 新建智能分镜表节点
2. 连接文字输入节点（分镜描述）或图像输入节点（参考图）
3. 配置分镜参数（3x3九宫格、角色一致性开关）
4. 执行生成，获得9宫格分镜表
5. 可选择单格替换或新建节点独立生成
6. 查看历史卡片回溯每次生成的提示词和参数

**成功标准**:
- 分镜表每格有独立的图像和提示词记录
- 支持从历史中恢复任意版本
- 角色在9个格子中保持视觉一致性

---

#### 场景2: AI绘图师多模型对比

**参与者**: AI绘图师

**前置条件**: 已配置多个图像生成模型

**操作流程**:
1. 创建图像生成节点A，选择模型A
2. 复制节点创建节点B，切换为模型B
3. 将同一提示词和参考图连接到两个节点
4. 并行执行生成
5. 在历史记录中并排对比两张结果
6. 选择满意的结果发送到画布继续创作

**成功标准**:
- 同一提示词可在不同模型间快速切换
- 历史记录支持并排对比视图
- 支持从历史记录一键发送到画布节点

---

#### 场景3: 视频创作者反推提示词

**参与者**: 短视频创作者

**前置条件**: 有参考视频素材

**操作流程**:
1. 创建视频输入节点，上传参考视频
2. 连接视频分析节点
3. 系统自动分析：场景、动作、镜头语言、色彩、节奏
4. 生成结构化提示词
5. 将提示词连接到视频生成节点
6. 配置参数（分辨率、时长、比例）后生成新视频

**成功标准**:
- 分析结果包含结构化JSON和自然语言描述
- 生成的提示词可直接用于视频生成
- 历史记录可追溯分析来源

---

#### 场景4: 角色素材库管理

**参与者**: 美术/设计师

**前置条件**: 本地缓存目录可用（Wails 绑定）

**操作流程**:
1. 从历史记录中选择满意的视频
2. 创建角色档案，提取角色头像
3. 系统自动缓存到本地
4. 在新建图像/视频节点中引用角色
5. 生成内容保持角色一致性

**成功标准**:
- 角色库支持快速预览和管理
- 引用角色的生成结果保持视觉一致性
- 本地缓存可离线使用

---

#### 场景5: 对话辅助创作

**参与者**: 创作团队成员

**前置条件**: 聊天模型已配置

**操作流程**:
1. 在对话侧栏描述创作需求
2. AI生成提示词或脚本
3. 一键发送到画布节点或分镜格
4. 节点自动填充内容并执行生成

**成功标准**:
- 对话产物可直接落地到工作流
- 支持多会话管理和历史回溯
- 支持文件附件作为参考

---

## 2. 核心功能模块

### 2.1 无限画布工作流编辑器
**优先级**: P0 (核心)

#### 功能描述
提供类似Figma/Miro的无限画布，用户可以在画布上自由创建、连接和组织工作流节点。

#### 核心能力
- **无限画布**: 支持缩放、平移、自由导航
- **节点系统**: 参见下文详细节点类型列表
- **连接机制**: 节点间通过连线传递数据和触发关系
- **异步进度追踪**: 视频生成等长耗时任务显示进度条，完成后通知
- **并行工作流**: 支持多个分支同时处理

> **技术说明**: AI 视频生成是长耗时任务（30秒-5分钟），界面设计为"提交任务 → 进入队列 → 轮询状态 → 下载结果"，而非"即时渲染"。

#### 节点类型列表

**输入节点**:
| 节点类型 | 功能 | 输出 |
|---------|------|------|
| `text-input` | 文字提示词输入 | string |
| `novel-input` | 小说/长文本输入 | chapters[], summary |
| `image-input` | 图像上传/粘贴/拖拽 | imageUrl, dimensions |
| `video-input` | 视频上传，关键帧选择 | videoUrl, keyframes[] |
| `character-ref` | 角色库引用 | characterId, avatarUrl |
| `batch-input` | 批量文件输入 | files[] |

**处理节点 - 图像生成**:
| 节点类型 | 功能 | 输入 | 输出 |
|---------|------|------|------|
| `image-gen` | 通用图像生成 | prompt, refs | imageUrl |
| `mj-gen` | Midjourney专用（支持网格） | prompt, refs | gridResult |
| `flux-gen` | Flux模型生成 | prompt, refs | imageUrl |
| `image-upscale` | 图像高清放大 | imageUrl, scale | hdImageUrl |
| `image-edit` | 图像编辑/重绘 | imageUrl, mask, prompt | editedUrl |
| `mask-editor` | 蒙版绘制 | imageUrl | maskDataUrl |
| `image-compare` | 图像对比（并排/差分） | imageA, imageB | comparisonResult |
| `image-variations` | 图像变体生成 | imageUrl, count | variants[] |

**处理节点 - 视频生成**:
| 节点类型 | 功能 | 输入 | 输出 |
|---------|------|------|------|
| `video-gen` | 通用视频生成 | prompt, imageRef | videoUrl |
| `video-img2vid` | 图生视频 | imageUrl, prompt | videoUrl |
| `video-keyframes` | 首尾帧视频生成 | firstFrame, lastFrame | videoUrl |
| `video-analyze` | 视频内容分析/反推提示词 | videoUrl | analysisJson |
| `video-extract` | 视频关键帧提取 | videoUrl, mode | keyframes[] |

**处理节点 - 分镜/辅助**:
| 节点类型 | 功能 | 输入 | 输出 |
|---------|------|------|------|
| `storyboard` | 智能分镜表（九宫格） | concept, characterRef | grid3x3 |
| `storyboard-expand` | 分镜扩展开 | singleFrame | expandedGrid |
| `prompt-enhance` | 提示词优化 | rawPrompt | enhancedPrompt |
| `chat-agent` | AI对话助手 | message, context | response |
| `preview-window` | 预览窗口（多图对比） | inputs[] | previewResult |

**输出节点**:
| 节点类型 | 功能 |
|---------|------|
| `output-image` | 图像输出展示/下载 |
| `output-video` | 视频输出展示/下载 |
| `output-json` | 结构化数据输出 |
| `save-local` | 保存到本地文件系统 |
| `export-workflow` | 导出工作流配置 |

**辅助节点**:
| 节点类型 | 功能 |
|---------|------|
| `comment` | 画布注释/说明 |
| `group` | 节点分组（折叠管理） |
| `router` | 条件分支路由 |
| `merge` | 多路合并 |
| `delay` | 延迟执行 |
| `batch-process` | 批量处理循环 |

#### 输出规格定义

**图像输出规格**:

| 参数 | 默认值 | 可选值 | 说明 |
|------|--------|--------|------|
| 分辨率 | 1024x1024 | 512x512 ~ 4096x4096 | 根据模型支持范围 |
| 宽高比 | 1:1 | 1:1, 16:9, 9:16, 4:3, 21:9 | 常用影视比例 |
| 格式 | PNG | PNG, JPEG, WEBP | 输出文件格式 |
| 质量 | 90 | 1-100 | JPEG/WEBP 质量 |
| 文件大小上限 | 50MB | - | 单图最大缓存 |

**视频输出规格**:

| 参数 | 默认值 | 可选值 | 说明 |
|------|--------|--------|------|
| 分辨率 | 1920x1080 | 720p ~ 4K | 根据模型支持范围 |
| 宽高比 | 16:9 | 16:9, 9:16, 1:1 | 常用视频比例 |
| 时长 | 5s | 3s ~ 25s | 根据模型限制 |
| 帧率 | 24fps | 24fps, 30fps | 输出帧率 |
| 格式 | MP4 | MP4, WEBM, MOV | 输出文件格式 |
| 文件大小上限 | 500MB | - | 单视频最大缓存 |

**关键帧提取规格**:

| 参数 | 默认值 | 可选值 | 说明 |
|------|--------|--------|------|
| 提取模式 | 智能采样 | 自动, 手动, 场景检测 | 提取策略 |
| 采样间隔 | 1秒 | 0.5s ~ 10s | 自动模式间隔 |
| 最大帧数 | 10 | 1 ~ 50 | 单次提取上限 |
| 输出格式 | JPEG | PNG, JPEG, WEBP | 帧图片格式 |

#### 节点交互设计

**拖放支持**:
- 从侧边栏拖拽节点到画布
- 拖拽连接线创建节点连接
- 拖拽文件到输入节点

**快捷键**:
- `Delete/Backspace` - 删除选中节点
- `Ctrl+Z` - 撤销
- `Ctrl+Shift+Z` - 重做
- `Ctrl+C/V` - 复制/粘贴节点
- `Space + 拖拽` - 平移画布
- `滚轮` - 缩放画布

**节点状态**:
- 空闲 (灰色边框)
- 运行中 (蓝色边框 + 动画)
- 完成 (绿色边框)
- 错误 (红色边框)

#### 参考产品
- FloraFauna: "Every creative AI tool. Thoughtfully connected"
- 行业领先产品: "无限画布 + 节点式AI影像创作工作流"

---

### 2.2 AI 模型集成层
**优先级**: P0 (核心)

#### 功能描述
通过各模型官网 API 调用，路线图规划集成 50+ 主流闭源 AI 模型，覆盖文字、图像、视频全链路。

**首发模型 (Phase 1)**:
- GPT-4o (OpenAI) - 对话助手
- Nano Banana (Google) - 图像生成
- Google Veo 3 (Google) - 视频生成

#### 模型集成策略

**集成方式**: 前端直接调用第三方模型官网 API (通过 BYOK 模式)
- OpenAI API: https://api.openai.com
- Runway API: https://dev-api.runwayml.com
- Kling API: https://api.klingai.com
- 其他模型: 各自官方 API 端点

**模型覆盖目标**: 路线图规划集成 50+ 主流闭源模型，Phase 2/3 逐步上线

#### 模型分类（路线图规划）

> **重要说明**: 以下模型列表为**路线图规划**，并非 MVP 阶段全部实现。Phase 1 仅集成 3 个首发模型（GPT-4o + Nano Banana + Veo 3），Phase 2/3 逐步扩展。

**Chat Models (对话模型)**:
| 模型ID | 提供商 | 主要用途 |
|--------|--------|----------|
| gpt-5-1 | OpenAI | 提示词生成、创意辅助 |
| gpt-5-2 | OpenAI | 高级推理、脚本创作 |
| gpt-4o | OpenAI | 多模态理解 |
| claude-4 | Anthropic | 长文本处理 |
| deepseek-v3 | DeepSeek | 性价比对话 |
| gemini-2.5-pro | Google | 多模态推理 |

**Image Models (图像模型)**:
| 模型ID | 提供商 | 特点 |
|--------|--------|------|
| nano-banana | Google | 快速生成 |
| nano-banana-2 | Google | 高质量生成 |
| flux-kontext | Flux | 上下文理解 |
| flux-pro | Flux | 专业级质量 |
| flux-redux | Flux | 图像精修 |
| mj-v6 | Midjourney | 艺术风格 |
| gpt-image-1.5 | OpenAI | 多参考图生成 |
| stable-diffusion-3.5 | Stability AI | 开源可控 |
| imagen-4 | Google | 照片级真实 |
| recraft-v3 | Recraft | 矢量/设计向 |

**Video Models (视频模型)**:
| 模型ID | 提供商 | 时长选项 | 特点 |
|--------|--------|----------|------|
| sora-2 | OpenAI | 5s, 10s, 15s | 高质量视频 |
| sora-2-pro | OpenAI | 15s, 25s | 电影级长视频 |
| google-veo3 | Google | 8s | 首尾帧支持 |
| google-veo3.1 | Google | 8s | 组件级生成 |
| kling-2.1 | 快手 | 5s, 10s | 中文场景优化 |
| runway-gen3 | Runway | 5s, 10s | 实时视频 |
| runway-gen4-turbo | Runway | 5s | 快速生成 |
| runway-act-two | Runway | 10s | 叙事视频 |
| pika-labs | Pika | 3s, 5s | 创意风格 |
| luma-dream-machine | Luma | 5s | 高清输出 |
| hailuo-2.3 | MiniMax | 5s, 8s | 角色一致性 |

#### 使用方式
- 统一调用接口
- 模型参数可视化配置
- 一键切换对比不同模型效果
- 成本预估和统计

#### 模型路线图（按阶段）

**Phase 1: MVP (4 周) - 首发模型**

| 模型 | 类型 | 优先级 | API难度 | 备注 |
|------|------|--------|---------|------|
| GPT-4o | Chat | P0 | 低 | 提示词生成、对话助手 |
| Nano Banana | Image | P0 | 低 | Google 快速生成模型 |
| Google Veo 3 | Video | P0 | 中 | 8s 视频生成，支持首尾帧 |

**降级策略**: 如果模型 API 不可用，前端显示降级提示，允许用户切换到备用模型

---

**Phase 2: 核心扩展 (6 周)**

| 模型 | 类型 | 优先级 | 上线顺序 | 备注 |
|------|------|--------|----------|------|
| Claude 4 | Chat | P0 | Week 1 (Phase 2) | 长文本处理 |
| Gemini 2.5 Pro | Chat | P1 | Week 2 (Phase 2) | 多模态推理 |
| MJ V6 | Image | P0 | Week 3 (Phase 2) | 网格分割处理 |
| GPT Image 1.5 | Image | P1 | Week 4 (Phase 2) | 多参考图生成 |
| Runway Gen-3 | Video | P0 | Week 5 (Phase 2) | 行业标准视频 |
| Pika Labs | Video | P1 | Week 5 (Phase 2) | 创意风格视频 |
| Google Veo 3 | Video | P1 | Week 6 (Phase 2) | 首尾帧支持 |
| Hailuo 2.3 | Video | P1 | Week 6 (Phase 2) | 角色一致性 |

**BYOK 模式说明**: 用户自行承担所有模型 API 费用，Firebringer 平台不收取任何费用

---

**Phase 3: 高级模型 (8 周)**

| 模型 | 类型 | 上线顺序 | 备注 |
|------|------|----------|------|
| Sora 2 | Video | Week 1-2 (Phase 3) | 高质量视频，需要等待官方 API |
| Sora 2 Pro | Video | Week 3-4 (Phase 3) | 电影级长视频 |
| Flux Pro | Image | Week 5 (Phase 3) | 专业级质量 |
| Recraft V3 | Image | Week 6 (Phase 3) | 矢量/设计向 |
| DeepSeek V3 | Chat | Week 7 (Phase 3) | 性价比对话 |

**备份策略**: 每个模型至少配置 1 个备用模型，当主模型失败时自动切换

---

**Phase 4: 生态完善 (未来规划)**

- 持续跟进新发布的模型
- 根据用户反馈调整模型优先级
- 探索本地模型部署方案（如 Stable Diffusion 本地运行）
- 云端托管版（统一计费、无需配置 API Key）

---

### 2.3 三段式创作流程
**优先级**: P0 (核心)

参考FloraFauna的创作哲学，将创作过程分为三个阶段：

#### 2.3.1 Ideate（构思阶段）
**目标**: 快速探索上百种可能性

**功能**:
- **灵感Agent**:
  - 输入简短想法
  - AI自动生成多个创意方向
  - 生成参考样片/分镜脚本

- **一键拉片**:
  - 上传参考视频
  - AI自动分析镜头语言、节奏、色调
  - 生成可编辑的分镜头脚本

- **快速原型**:
  - 文字生成分镜图
  - 粗略动画预览
  - 多方案并排对比

#### 2.3.2 Iterate（迭代阶段）
**目标**: 快速迭代方案，达到 "final"

**功能**:
- **精细化编辑**:
  - 角色替换（保持一致性）
  - 背景替换/场景迁移
  - 镜头重排
  - 节奏调整

- **版本管理** (本地):
  - 保存多个版本到本地
  - 本地版本对比
  - 一键回滚

> **注意**: 团队协作、实时编辑功能规划在 Phase 4

#### 2.3.3 Scale（扩展阶段）
**目标**: 将一个概念扩展为数百个成品

**功能**:
- **批量生成**:
  - 基于模板批量生成变体
  - A/B测试不同版本
  - 多尺寸/多格式输出

- **品牌一致性**:
  - 保存品牌资产（Logo、色板、字体）
  - 自动应用到所有生成内容
  - 品牌合规检查

#### 2.3.4 分镜节点规格

**输入规格**:
```typescript
interface StoryboardInput {
  concept: string;           // 创意描述 (100-2000字)
  characterRef?: string;     // 角色库引用ID
  style?: string;            // 风格描述
  aspectRatio: '1:1' | '16:9' | '9:16' | '4:3' | '21:9';
  gridLayout: '3x3' | '2x2' | '4x4';  // 网格布局
  maintainConsistency: boolean;  // 角色一致性开关
  referenceImages?: string[];  // 参考图URL
}
```

**输出规格**:
```typescript
interface StoryboardOutput {
  id: string;
  gridLayout: string;
  cells: StoryboardCell[];
  metadata: {
    model: string;
    prompt: string;
    generatedAt: number;
    consistencyScore: number;  // 0-1, 一致性评分
  };
}

interface StoryboardCell {
  position: { row: number; col: number };
  image: string;              // 生成的图像URL
  prompt: string;             // 该格的提示词
  shotType?: 'close-up' | 'medium' | 'wide' | 'extreme-close-up';
  action?: string;            // 动作描述
  duration?: number;          // 预计时长(秒)
}
```

**尺寸约束**:
| 宽高比 | 输出分辨率 | 单格大小 | 完整网格大小 |
|--------|-----------|----------|-------------|
| 1:1 | 1024x1024 | 341x341 | 1024x1024 |
| 16:9 | 1920x1080 | 640x360 | 1920x1080 |
| 9:16 | 1080x1920 | 360x640 | 1080x1920 |

**角色一致性判定标准**:
| 评估维度 | 检测方式 | 合格阈值 |
|----------|----------|----------|
| 面部特征 | 人脸关键点对比 | 相似度 > 0.85 |
| 服装/发型 | 视觉特征提取 | 相似度 > 0.80 |
| 色彩风格 | HSV色彩直方图 | 相似度 > 0.75 |
| 整体评分 | 综合加权平均 | > 0.80 |

**验收标准 (DoD)**:
- [ ] 9个格子全部生成完成
- [ ] 一致性评分 > 0.80
- [ ] 每格提示词记录完整
- [ ] 支持单格重新生成
- [ ] 支持导出为单图或完整网格
- [ ] 生成时间 < 60秒

---

### 2.4 预设工作流库
**优先级**: P1 (重要)

提供开箱即用的专业工作流模板。

#### 工作流分类

**广告营销类**:
- 电商产品视频（15s/30s/60s）
- 品牌宣传片
- 社交媒体广告（抖音、小红书、Instagram）
- 节日营销视频

**影视创作类**:
- MV 创作流程
- 短片制作
- 预告片生成
- 分镜可视化

**设计创意类**:
- 虚拟拍摄（产品摄影）
- 服装试穿展示
- 建筑可视化
- Logo 动画生成

**MVP 阶段特点**:
- 内置预设工作流（由团队验证）
- 一键应用到新项目
- 支持二次编辑和本地保存
- 导出工作流为 JSON 文件分享

> **未来规划 (Phase 4)**: 工作流市场（购买/出售）、社区分享平台

---

### 2.5 高级编辑工具集
**优先级**: P1 (重要)

#### 2.5.1 视频编辑节点
- 剪辑/拼接
- 转场效果
- 音频同步
- 字幕生成（多语言）
- 镜头变换（推拉摇移）

#### 2.5.2 图像编辑节点
- 抠图/背景移除
- 图像修复/扩展
- 风格迁移
- 色彩分级
- 光照调整

#### 2.5.3 AI特殊功能
- 角色一致性保持（跨多镜头）
- 口型同步
- 动作捕捉转动画
- 声音设计（AI生成配乐/音效）

---

### 2.6 项目管理与协作

> **注意**: 以下功能为**未来规划** (Phase 4)，MVP 阶段仅支持基础本地项目管理。

**优先级**: P2 (未来规划)

#### 2.6.1 本地项目管理 (MVP)

- 项目列表（类似当前的ProjectList）
- 项目分类/标签
- 收藏和搜索
- 项目封面预览

#### 2.6.2 团队协作 (未来规划)

以下功能涉及复杂的实时协作和冲突解决，规划在 Phase 4 实现：

**角色与权限模型**:

| 角色 | 描述 | 权限 |
|------|------|------|
| **Owner** | 项目所有者 | 全部权限，包括删除项目、管理成员 |
| **Admin** | 管理员 | 编辑工作流、管理成员、修改项目设置 |
| **Editor** | 编辑者 | 编辑工作流、生成内容、查看历史 |
| **Viewer** | 查看者 | 仅查看，无法编辑 |

**实时协作** (涉及 OT/CRDT 算法):
- WebSocket 连接实现多人在线状态
- 显示其他用户的鼠标位置和选中节点
- 冲突解决 UI

> **技术说明**: 实时协作需要实现 OT (Operational Transformation) 或 CRDT (Conflict-free Replicated Data Types) 算法，这是极其复杂的工程挑战，不在 MVP 范围内。

---

### 2.7 AI助手聊天面板
**优先级**: P2 (增强)

已集成在CanvasView中，需要增强功能：

#### 功能增强
- **智能对话**:
  - 解释工作流
  - 优化提示词
  - 推荐模型和参数
  - 故障诊断

- **自然语言操作**:
  - "帮我把这个角色换到海滩场景"
  - "生成3种不同风格的版本"
  - "保持这个风格再生成10秒"

- **学习中心**:
  - 工作流教程
  - 最佳实践案例
  - 社区作品解析

---

### 2.8 工作流市场 (未来规划)

> **注意**: 以下功能为**未来规划** (Phase 4)，需要完整的支付、税务、法务基础设施支持。

**优先级**: P2 (未来规划)

创作者可以发布、出售工作流模板，用户可以购买并直接使用。

#### 2.8.1 MVP 替代方案

在 MVP 阶段，工作流分享采用以下方式：
- 导出工作流为 JSON 文件
- 通过 GitHub/社区分享工作流配置
- 用户手动导入工作流 JSON

#### 2.8.2 未来市场功能 (Phase 4)

**工作流发布**:
- 创作者上传工作流JSON
- 填写元数据（名称、描述、分类、预览图）
- 设置定价（免费/固定价格/积分）
- 添加使用教程和示例

**工作流购买**:
- 浏览市场（按分类/热度/评分筛选）
- 预览工作流结构和示例输出
- 一键购买并导入到项目

> **技术说明**: 工作流市场涉及支付处理、KYC、税务处理（W-9/W-8BEN）、版权审核等复杂基础设施，不在 MVP 范围内。

---

### 2.9 提示词库系统
**优先级**: P1 (重要)

**设计背景**: 基于行业最佳实践分析，提示词库是大幅提升用户效率的关键功能。

#### 功能描述
提供预设提示词模板库，用户可以快速应用到节点，也可保存自定义提示词。

#### 预设模板分类

**分镜脚本类**:
| 模板名 | 用途 |
|--------|------|
| 九宫格分镜脚本 | 生成3x3角色动作表，保持角色一致性 |
| 分镜版生成 | 多镜头场景分镜 |
| 角色板生成 | 统一风格的角色多角度展示 |

**图像处理类**:
| 模板名 | 用途 |
|--------|------|
| 高清放大 | Upscale图像分辨率 |
| 情绪版生成 | 风格参考图集合 |
| 风格迁移 | 保持构图改变风格 |

**视频生成类**:
| 模板名 | 用途 |
|--------|------|
| 静图动起来 | 图片转视频过渡 |
| 镜头推拉 | 模拟相机运镜 |
| 循环视频 | 无缝循环素材 |

#### 数据结构
```typescript
interface PromptTemplate {
  id: string;
  name: string;
  category: 'storyboard' | 'image' | 'video' | 'chat';
  prompt: string;
  variables?: string[];  // 可替换的变量
  createdAt: number;
  isBuiltIn: boolean;
}
```

#### 交互设计
- 侧边栏展示模板列表
- 点击模板一键应用到选中节点
- 支持收藏常用模板
- 支持从成功案例保存为模板

---

### 2.9 角色库系统
**优先级**: P1 (重要)

角色一致性是视频创作的核心痛点，独立的角色库系统至关重要。

#### 功能描述
本地角色预设系统，用户保存角色图后，下次生成时 App 自动将其作为 reference image 参数传给 API。

#### 核心功能

**角色创建**:
- 从视频URL创建角色
- 从历史记录中选择视频创建
- 上传本地视频文件
- 自动提取角色头像

**角色管理**:
- 角色列表展示
- 本地缓存角色头像
- 角色删除/编辑

**角色引用**:
- 在图像生成节点引用角色
- 在视频生成节点引用角色
- 保持跨镜头一致性

> **技术说明**: 这是客户端功能，不涉及云端"角色库同步"接口。角色图片作为 reference image 参数传递给 AI 模型 API。

#### 数据结构
```typescript
interface Character {
  id: string;
  name: string;
  avatarUrl?: string;
  localAvatarCache?: string;
  sourceVideoUrl: string;
  sourceType: 'url' | 'upload' | 'history';
  createdAt: number;
}
```

#### UI设计
```
┌─────────────────────────────────┐
│  角色库                    [+]  │
├─────────────────────────────────┤
│  ┌─────┐ ┌─────┐ ┌─────┐      │
│  │头像 │ │头像 │ │头像 │      │
│  │名字 │ │名字 │ │名字 │      │
│  │同步 │ │     │ │同步 │      │
│  └─────┘ └─────┘ └─────┘      │
│  [新建角色] [从历史创建]       │
└─────────────────────────────────┘
```

---

### 2.10 关键帧提取
**优先级**: P1 (重要)

视频工作流的基础功能，用于提取参考帧传递给下游节点。

#### 功能描述
视频输入节点支持自动/手动提取关键帧，作为图像参考传递给生成节点。

#### 核心功能

**自动提取**:
- 基于场景变化自动识别
- 智能采样（每N秒提取一帧）
- 运动检测提取关键动作

**手动选择**:
- 时间轴预览
- 拖动选择多帧
- 单帧精确选择

**传递机制**:
- 多帧并行传递给图像生成
- 首尾帧传递给视频生成
- 支持帧顺序控制

#### 节点交互
```
┌──────────────────┐
│   video-input    │
│  ┌────────────┐  │
│  │  时间轴    │  │
│  │ [][★][][★]│  │ ← ★=选中关键帧
│  └────────────┘  │
└────────┬─────────┘
         │ 关键帧数组
         ▼
┌──────────────────┐
│  image-gen       │
│  参考: 帧1, 帧3   │
└──────────────────┘
```

---

### 2.11 Midjourney网格处理
**优先级**: P1 (重要)

Midjourney默认返回4图网格，需要智能分割和单图选择。

#### 功能描述

**网格识别**:
- 自动检测4图网格（2x2）
- 支持不同分辨率
- 自动分割为独立图像

**单图选择**:
- 点击选择单图
- 选择后作为独立输出
- 保留原图和分割图

**批量处理**:
- 网格转4个独立任务
- 每个任务独立继续生成
- 支持选择多个进行后续操作

#### 数据结构
```typescript
interface MJGridResult {
  id: string;
  originalUrl: string;
  images: string[];      // 分割后的4张图
  selected: number;      // 当前选中索引 (0-3)
  ratio: '1:1' | '16:9' | '9:16';
}
```

---

### 2.12 首尾帧视频生成
**优先级**: P1 (重要)

精准控制视频的起始和结束状态，适用于过渡视频生成。

#### 功能描述

**首尾帧输入**:
- 上传首帧图像
- 上传尾帧图像
- AI生成中间过渡视频

**使用场景**:
- 角色姿态过渡
- 场景转换
- 产品角度变化
- 动作衔接

**支持模型**:
- Google Veo 3.1 (原生支持)
- Kling 2.1 (首尾帧模式)
- Luma Dream Machine

#### 节点配置
```
┌──────────────────────────────┐
│     video-gen (首尾帧模式)    │
├──────────────────────────────┤
│ 首帧: [上传图片]              │
│ 尾帧: [上传图片]              │
│ 提示词: 平滑过渡，保持角色     │
│ 时长: 5s                      │
└──────────────────────────────┘
```

---

### 2.13 视频分析节点
**优先级**: P1 (重要)

分析视频内容，提取结构化信息供下游使用。

#### 功能描述

**分析维度**:
- 场景检测（室内/室外/时间段）
- 动作识别
- 镜头语言（推拉摇移）
- 色彩分析
- 节奏/剪辑点检测

**输出格式**:
- 结构化JSON描述
- 自然语言总结
- 标签提取

#### 下游应用
- 基于分析结果生成提示词
- 风格迁移参考
- 相似视频检索

---

### 2.14 本地存储系统
**优先级**: P0 (核心)

完整的本地配置和缓存系统，确保用户体验流畅。

#### 存储结构

| 存储键 | 数据类型 | 用途 |
|--------|----------|------|
| `firebringer_theme` | string | 主题设置 (dark/light) |
| `firebringer_api_configs` | ApiConfig[] | API配置列表 |
| `firebringer_global_key` | string | 全局API密钥 |
| `firebringer_project_name` | string | 当前项目名 |
| `firebringer_prompt_library` | PromptTemplate[] | 提示词库 |
| `firebringer_characters` | Character[] | 角色库 |
| `firebringer_canvas_state` | CanvasState | 画布状态 |
| `firebringer_performance_mode` | boolean | 性能模式 |
| `firebringer_history` | HistoryItem[] | 生成历史 |

#### 数据结构定义
```typescript
interface ApiConfig {
  id: string;
  provider: string;
  modelName: string;
  type: 'Chat' | 'Image' | 'Video';
  key: string;
  url: string;
  durations?: string[];  // 视频模型时长选项
}

interface CanvasState {
  nodes: Node[];
  connections: Connection[];
  viewport: { x: number; y: number; zoom: number };
}

interface HistoryItem {
  id: string;
  type: 'image' | 'video';
  status: 'pending' | 'processing' | 'completed' | 'failed';
  prompt: string;
  url?: string;
  thumbnailUrl?: string;
  modelName: string;
  createdAt: number;
  durationMs?: number;
  width?: number;
  height?: number;
  mjImages?: string[];      // MJ网格图
  mjSelectedIndex?: number;
}
```

#### 性能优化
- 虚拟列表渲染历史记录
- 图像懒加载
- Base64缓存减少请求
- 增量同步

---

## 3. 用户体验设计

### 3.1 界面布局

```
┌─────────────────────────────────────────────────────────┐
│  顶部工具栏: 后退 | 项目名称 | 导出 | 分享 |  AI助手    │
├──────────┬──────────────────────────────────────────────┤
│          │                                              │
│ 左侧     │           无限画布区域                        │
│ 工具栏   │           ┌──────┐    ┌──────┐             │
│          │           │ 输入 │───▶│ 生成 │             │
│ - 节点库 │           │ 节点 │    │ 节点 │             │
│ - AI模型 │           └──────┘    └──────┘             │
│ - 模板   │               │         │                  │
│          │               ▼         ▼                  │
│          │           ┌─────────────────┐              │
│          │           │    输出节点     │              │
│          │           └─────────────────┘              │
│          │                                              │
└──────────┴──────────────────────────────────────────────┘
```

### 3.2 交互设计原则
1. **所见即所得**: 节点配置立即预览
2. **拖拽式操作**: 所有元素支持拖拽
3. **快捷键支持**: 专业用户效率
4. **响应式反馈**: 加载状态、错误提示清晰

### 3.3 视觉风格
- 深色主题（创作者友好）
- 节点卡片采用渐变色彩区分类型
- 连接线使用贝塞尔曲线
- 高对比度的选中状态

---

## 4. 技术架构

### 4.1 产品形态定义

**核心定位**: Wails 桌面应用 (Desktop-First)

```
┌─────────────────────────────────────────────────────────────┐
│                    Firebringer 架构图                        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌────────────────────────────────────────────────────┐     │
│  │              Wails 桌面客户端                        │     │
│  │                                                     │     │
│  │  ┌─────────────────────────────────────────────┐   │     │
│  │  │            React 19 前端                      │   │     │
│  │  │  ┌─────────┐  ┌─────────┐  ┌─────────────┐  │   │     │
│  │  │  │ 无限画布 │  │ 节点编辑 │  │  UI 组件     │  │   │     │
│  │  │  │ReactFlow│  │  器     │  │  shadcn/ui   │  │   │     │
│  │  │  └─────────┘  └─────────┘  └─────────────┘  │   │     │
│  │  └─────────────────────────────────────────────┘   │     │
│  │                       ↕ Wails IPC                   │     │
│  │  ┌─────────────────────────────────────────────┐   │     │
│  │  │            Go 后端                            │   │     │
│  │  │  ┌─────────┐  ┌─────────┐  ┌─────────────┐  │   │     │
│  │  │  │ 文件读写 │  │ 本地配置 │  │  系统调用    │  │   │     │
│  │  │  └─────────┘  └─────────┘  └─────────────┘  │   │     │
│  │  └─────────────────────────────────────────────┘   │     │
│  └────────────────────────────────────────────────────┘     │
│                              ↕ HTTPS API                     │
│  ┌────────────────────────────────────────────────────┐     │
│  │              第三方 AI 模型服务                       │     │
│  │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐      │     │
│  │  │ OpenAI │ │Runway  │ │ Kling  │ │ SD3.5  │ ... │     │
│  │  └────────┘ └────────┘ └────────┘ └────────┘      │     │
│  └────────────────────────────────────────────────────┘     │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**架构说明**:
- **Wails 桌面客户端**: 所有 UI、画布编辑、节点管理都在本地运行
- **Go 后端**: 提供本地文件读写、SQLite 数据库、系统 Keychain 功能
- **第三方 AI 模型服务**: 通过 HTTPS API 调用，需要公网连接

**离线 vs 在线能力**:
| 功能 | 离线可用 | 需要联网 |
|------|----------|----------|
| 画布编辑、节点操作、项目管理 | ✅ | ❌ |
| 历史记录查看、版本管理 | ✅ | ❌ |
| AI 图像生成 | ❌ | ✅ |
| AI 视频生成 | ❌ | ✅ |
| AI 对话助手 | ❌ | ✅ |

#### 4.1.1 数据流向

| 数据类型 | 存储位置 | 访问方式 |
|----------|----------|----------|
| 项目配置 (工作流JSON) | 本地文件系统 | Wails Bindings |
| 生成内容 (图片/视频) | 本地缓存目录 | Wails Bindings |
| API配置 | 本地加密存储 | Wails Bindings + Keychain |
| 历史记录 | SQLite | Wails Bindings |
| 临时状态 | React State (内存) | 前端直接访问 |

**存储架构说明**:
- **SQLite**: 项目、配置、历史记录的主存储
- **本地文件系统**: 生成图片/视频的缓存目录
- **React State**: 运行时临时状态，应用关闭后清空

#### 4.1.2 API调用方式

**BYOK (Bring Your Own Key)** 模式:
- 用户在设置页配置自己的 API Key
- 前端直接调用第三方 AI 模型 API
- API Key 本地加密存储 (使用系统 Keychain)
- Firebringer 不做中间代理，无额外费用

#### 4.1.3 网络依赖说明

**重要**: 虽然 Firebringer 是本地桌面应用，但 AI 生成功能**强依赖公网连接**。

- ✅ 离线可用: 画布编辑、项目管理、历史查看
- ❌ 离线不可用: AI 图像/视频生成、模型调用

**网络异常处理**:
- API 超时: 显示重试按钮，支持手动重试
- 网络中断: 标记任务为"待处理"，网络恢复后继续
- 余额不足 (用户自备API): 显示提示，引导用户检查账户

#### 4.1.4 API 错误处理规范

**错误类型与处理**:

| 错误类型 | HTTP状态 | UI处理 | 用户操作 |
|----------|----------|--------|----------|
| 超时 (Timeout) | 408/504 | 显示"请求超时，请重试" | 点击重试按钮 |
| 网络中断 | - | 显示"网络连接已断开" | 检查网络后重试 |
| API Key无效 | 401 | 显示"API Key无效，请检查配置" | 跳转到设置页 |
| 余额不足 | 402 | 显示"账户余额不足" | 跳转到模型提供商充值 |
| 速率限制 | 429 | 显示"请求过于频繁，请稍后" | 等待后自动重试 |
| 服务器错误 | 500/503 | 显示"服务暂时不可用" | 稍后重试 |
| 内容审核拒绝 | 451 | 显示"生成内容违反安全规则" | 修改提示词后重试 |

**重试策略**:
```typescript
interface RetryConfig {
  maxRetries: number;      // 最大重试次数 (默认3次)
  backoffMs: number;       // 退避基数 (默认1000ms)
  retryableStatus: number[]; // 可重试的状态码
}

const DEFAULT_RETRY_CONFIG: RetryConfig = {
  maxRetries: 3,
  backoffMs: 1000,
  retryableStatus: [408, 429, 500, 502, 503, 504],
};
```

**错误日志记录**:
- 所有 API 错误记录到本地日志文件
- 记录内容包括: 时间、API端点、错误码、错误消息
- 支持导出日志用于故障排查

---

### 4.2 前端技术栈（已选型）

| 技术 | 版本 | 用途 |
|------|------|------|
| React | 19 | UI框架 |
| TypeScript | 5.x | 类型系统 |
| Tailwind CSS | 4.x | 样式 |
| shadcn/ui | latest | UI组件 |
| @xyflow/react | 12.x | 画布/节点编辑器 ✅ 已集成 |
| Wails | v2 | 桌面框架 ✅ 已使用 |

### 4.3 后端技术栈

| 技术 | 用途 |
|------|------|
| Go 1.21+ | Wails 后端逻辑 |
| SQLite | 本地数据库（项目、配置、历史记录） |
| 本地文件系统 | 生成内容缓存 |
| 系统 Keychain | API Key 加密存储 |

### 4.4 云端技术栈（未来规划）

> 以下技术栈为**未来商业化规划**，MVP 阶段不涉及。

| 技术 | 用途 |
|------|------|
| PostgreSQL | 云端数据库 |
| AWS S3 / Cloudflare R2 | 文件存储 |
| Redis | 任务队列 |
| Stripe | 支付处理 |

### 4.5 平台支持

| 平台 | 支持状态 | 备注 |
|------|----------|------|
| Windows 10+ | ✅ MVP | 主要目标 |
| macOS 12+ | ✅ MVP | 主要目标 |
| Linux | ⚠️ Phase 2 | 社区支持 |

**系统要求**:
- 需要 Wails 桌面运行时支持
- 需要 SQLite 支持（所有平台内置）
- 需要系统 Keychain 支持（Windows DPAPI/macOS Keychain/Linux Secret Service）

---

### 4.4 性能优化方案

#### 4.4.1 性能模式

**触发条件**:
- 画布节点数量 > 50
- 用户手动启用
- 检测到渲染帧率 < 30fps

**优化策略**:
| 策略 | 实现方式 |
|------|----------|
| 视口裁剪 | 仅渲染可见区域内的节点 |
| 媒体降载 | 离屏节点隐藏img/video，保留骨架DOM |
| 缩略图替代 | 使用生成的JPEG缩略图替代原图 |
| 降低更新频率 | 减少实时预览刷新频率 |
| 禁用动画 | 关闭节点动画效果 |

**数据结构**:
```typescript
interface PerformanceMode {
  enabled: boolean;
  threshold: number;        // 触发阈值（节点数）
  thumbnailQuality: number; // 缩略图质量 1-100
  updateInterval: number;   // 更新间隔 ms
}
```

#### 4.4.2 虚拟列表优化

**应用场景**: 历史记录列表、角色库、节点库

**实现要点**:
- 动态计算可视区域
- 仅渲染可见项 + 缓冲区
- 懒加载图像资源
- 回收不可见DOM节点

```typescript
interface VirtualListConfig {
  itemHeight: number;      // 单项高度
  overscan: number;        // 预渲染项数
  bufferSize: number;      // 缓冲区大小
}
```

#### 4.4.3 画布交互优化

**拖拽与缩放**:
- 使用 `requestAnimationFrame` 优化渲染
- 使用 `Pointer Events` 统一处理鼠标/触摸
- 拖拽时禁用节点的 `pointer-events` 减少抖动

**连接线渲染**:
- 使用贝塞尔曲线
- 大量连接时使用层级渲染
- 离屏连接线简化显示

#### 4.4.4 缩略图生成

**生成策略**:
- 离屏 Canvas 生成 JPEG
- 质量可调（默认 75%）
- 异步生成，不阻塞主线程
- 缓存到本地文件系统（Wails Bindings）

```typescript
interface ThumbnailConfig {
  maxWidth: number;   // 最大宽度
  maxHeight: number;  // 最大高度
  quality: number;    // JPEG质量 0-100
  format: 'jpeg' | 'webp';
}
```

---

### 4.5 本地文件管理服务 (Wails Bindings)

#### 4.5.1 服务架构

**实现方式**: 通过 Wails Runtime Bindings，前端直接调用 Go 侧文件读写方法。

**功能**:
- 保存图片/视频到本地缓存目录
- 读取本地文件
- 批量文件操作
- 缓存路径管理

#### 4.5.2 Go 后端接口定义

```go
// main.go

package main

import (
    "context"
    "encoding/base64"
    "io/ioutil"
    "os"
    "path/filepath"
)

// FileSaveResult 文件保存结果
type FileSaveResult struct {
    Success bool   `json:"success"`
    Path    string `json:"path"`
    Size    int64  `json:"size"`
    Error   string `json:"error,omitempty"`
}

// CacheInfo 缓存信息
type CacheInfo struct {
    Path      string `json:"path"`
    TotalSize int64  `json:"totalSize"`
    FileCount int    `json:"fileCount"`
}

// SaveFile 保存文件到本地缓存
func SaveFile(data string, filename string, fileType string) (*FileSaveResult, error) {
    // 获取缓存目录
    cacheDir := getCacheDir(fileType)
    if err := os.MkdirAll(cacheDir, 0755); err != nil {
        return &FileSaveResult{Success: false, Error: err.Error()}, err
    }

    // 解码 base64
    decoded, err := base64.StdEncoding.DecodeString(data)
    if err != nil {
        return &FileSaveResult{Success: false, Error: "Invalid base64 data"}, err
    }

    // 生成唯一文件名
    ext := filepath.Ext(filename)
    uniqueName := generateUUID() + ext
    filePath := filepath.Join(cacheDir, uniqueName)

    // 写入文件
    if err := ioutil.WriteFile(filePath, decoded, 0644); err != nil {
        return &FileSaveResult{Success: false, Error: err.Error()}, err
    }

    info, _ := os.Stat(filePath)
    return &FileSaveResult{
        Success: true,
        Path:    filePath,
        Size:    info.Size(),
    }, nil
}

// GetCacheInfo 获取缓存信息
func GetCacheInfo() (*CacheInfo, error) {
    cacheDir := getCacheDir("")
    var totalSize int64
    fileCount := 0

    filepath.Walk(cacheDir, func(path string, info os.FileInfo, err error) error {
        if !info.IsDir() {
            totalSize += info.Size()
            fileCount++
        }
        return nil
    })

    return &CacheInfo{
        Path:      cacheDir,
        TotalSize: totalSize,
        FileCount: fileCount,
    }, nil
}

// ClearCache 清空缓存
func ClearCache(fileType string) error {
    cacheDir := getCacheDir(fileType)
    return os.RemoveAll(cacheDir)
}

func getCacheDir(fileType string) string {
    // 跨平台缓存目录
    homeDir, _ := os.UserHomeDir()
    var baseDir string

    switch filepath.Separator {
    case '\\':
        baseDir = filepath.Join(homeDir, "FirebringerCache")
    default:
        baseDir = filepath.Join(homeDir, ".firebringer", "cache")
    }

    if fileType == "" {
        return baseDir
    }
    return filepath.Join(baseDir, fileType)
}
```

#### 4.5.3 前端调用方式

```typescript
// Wails 自动生成的类型定义
export interface FileSaveResult {
  success: boolean;
  path?: string;
  size?: number;
  error?: string;
}

// 调用 Go 方法
import { SaveFile, GetCacheInfo, ClearCache } from '../wailsjs/go/main/App';

// 保存文件
async function saveImage(base64Data: string, filename: string) {
  const result = await SaveFile(base64Data, filename, 'image');
  if (result.success) {
    console.log('Saved to:', result.path);
  }
}

// 获取缓存信息
const cacheInfo = await GetCacheInfo();
console.log('Cache size:', cacheInfo.totalSize);
```

#### 4.5.4 文件限制

| 限制项 | 默认值 | 说明 |
|--------|--------|------|
| 单文件大小 | 500MB | 可配置 |
| 支持格式 | jpg, png, webp, mp4, mov, webm | 可扩展 |

#### 4.5.5 跨平台路径处理

```typescript
// 缓存路径配置
interface PathConfig {
  windows: string;     // C:\Users\<User>\FirebringerCache
  macos: string;       // ~/Library/Application Support/Firebringer/Cache
  linux: string;       // ~/.firebringer/cache
}
```

#### 4.5.6 缓存管理UI

```
┌─────────────────────────────────┐
│  缓存管理                        │
├─────────────────────────────────┤
│  缓存路径: C:\Users\...\FirebringerCache  │
│  [更改路径] [打开目录]          │
│                                  │
│  缓存统计:                       │
│  - 图像: 150 (2.3GB)             │
│  - 视频: 120 (1.8GB)             │
│  - 总计: 270 (4.1GB)             │
│                                  │
│  [清空图像缓存] [清空视频缓存]   │
└─────────────────────────────────┘
```

---

### 4.6 对话侧栏设计

#### 4.6.1 界面布局

```
┌─────────────────────────────────┐
│  💬 AI 助手               [设置] │
├─────────────────────────────────┤
│  会话历史                        │
│  ├ 📝 分镜脚本生成             │
│  ├ 🎨 提示词优化               │
│  └ 📹 视频分析                 │
├─────────────────────────────────┤
│  聊天区域                        │
│  ┌─────────────────────────────┐ │
│  │ AI: 你好！我可以帮你...    │ │
│  │ 用户: 帮我优化这个提示词    │ │
│  │ ...                        │ │
│  └─────────────────────────────┘ │
│  [输入消息...]         [发送]    │
│  [📎 附件]                       │
├─────────────────────────────────┤
│  [发送到节点] [发送到分镜]       │
└─────────────────────────────────┘
```

#### 4.6.2 功能特性

**多会话管理**:
- 创建/删除/重命名会话
- 会话本地存储
- 会话搜索

**模型选择**:
- 支持切换聊天模型
- 显示模型在线状态
- 支持自定义模型配置

**一键发送**:
- 发送到画布节点
- 发送到分镜格
- 发送到提示词库

**文件附件**:
- 支持上传图片参考
- 支持上传视频分析
- 支持上传文本文件

---

## 5. 开发路线图

### Phase 1: MVP (最小可行产品) - 4 周
**时间**: Week 1-4
**目标**: 基础工作流编辑器 + 3 个首发 AI 模型

- [x] 无限画布界面（基于 ReactFlow）
- [ ] 节点系统（输入/处理/输出）
- [ ] 集成 1 个图像生成模型（Nano Banana）
- [ ] 集成 1 个视频生成模型（Google Veo 3）
- [ ] 集成 1 个对话模型（GPT-4o）
- [ ] 基础的项目管理（本地）
- [ ] API Key 配置管理（BYOK 模式）
- [ ] 简单的导出功能

**验收标准**:
- 可以创建节点、连接节点、执行生成
- 支持基本的图像和视频生成
- 所有数据存储在本地

---

### Phase 2: 核心功能 - 6 周
**时间**: Week 5-10
**目标**: 完整的单机创作流程

- [ ] 完整的节点库（10+ 种节点类型）
- [ ] 提示词库系统
- [ ] 角色库系统（本地预设）
- [ ] 版本管理（本地）
- [ ] 3-5 个预设工作流模板
- [ ] 批量生成功能
- [ ] 媒体库管理（本地）
- [ ] 关键帧提取
- [ ] 蒙版编辑器
- [ ] 九宫格分镜表
- [ ] 集成更多 AI 模型（Claude, MJ, Runway, Pika, Veo, Hailuo）

**验收标准**:
- 支持完整的创作流程（输入 → 生成 → 编辑 → 导出）
- 所有功能支持本地使用
- 无需登录、无云端功能

---

### Phase 3: 高级功能 - 8 周
**时间**: Week 11-18
**目标**: 专业级单机能力

- [ ] 视频分析节点
- [ ] 首尾帧视频生成
- [ ] Midjourney 网格处理
- [ ] 图像对比节点
- [ ] 预览窗口
- [ ] 高级编辑工具（角色一致性、场景替换）
- [ ] 多 AI 模型并行对比
- [ ] 音频生成和同步
- [ ] 本地文件管理（Wails Bindings）
- [ ] 缓存管理系统
- [ ] 对话侧栏增强
- [ ] 性能模式优化
- [ ] 虚拟列表优化
- [ ] 集成高级模型（Sora 2, Flux Pro, Recraft V3, DeepSeek V3）

**验收标准**:
- 支持复杂的多步骤工作流
- 性能优化（50+ 节点流畅运行）
- 所有 AI 模型通过官网 API 调用

---

### Phase 4: 生态建设 - 持续
**时间**: Week 19+
**目标**: 商业化和协作

- [ ] 团队协作功能（多人编辑）
- [ ] 实时协作（WebSocket + CRDT）
- [ ] 工作流市场（购买/出售）
- [ ] 作品分享社区
- [ ] 积分充值系统（BYOK 之外的选择）
- [ ] 云端托管版（统一计费）
- [ ] 插件系统
- [ ] API 开放平台
- [ ] 付费订阅模式

**验收标准**:
- 完整的 SaaS 商业化能力
- 企业级协作功能
- 开发者生态系统

---

## 6. 成功指标 (KPIs)

### 产品指标
- **日活用户 (DAU)**: > 1000 (3个月内)
- **工作流创建数**: > 5000/月
- **视频生成完成率**: > 85%
- **用户留存率**: 7日留存 > 40%

### 质量指标
- **生成视频质量**: TV级标准
- **生成速度**: 15秒视频 < 3分钟
- **系统稳定性**: 崩溃率 < 0.1%

### 商业指标
- **付费转化率**: > 5%
- **ARPU**: > $20/月
- **NPS**: > 50

---

## 7. 商业模式

> **MVP 阶段定位**: Firebringer v2.0 采用 **BYOK (Bring Your Own Key)** 模式，用户自带 API Key 直接调用第三方模型，平台不收取任何费用。

### 7.1 MVP 阶段 (Phase 1-3): 免费桌面应用 (BYOK 模式)

**产品形态**:
- 桌面应用 (Windows/macOS/Linux)
- 用户自行配置 API Key (OpenAI, Runway, Kling 等)
- 所有数据存储在本地，保护隐私
- 无登录、无积分、无支付系统
- 开源或免费下载

**成本结构**:
- 用户直接承担第三方 AI 模型的 API 费用
- Firebringer 平台: 零运营成本（仅开发和维护成本）

**商业模式**: 免费 + 开源社区
- 吸引用户使用，建立开发者社区
- 收集反馈，迭代产品
- 为未来商业化奠定用户基础

### 7.2 未来商业化规划 (Phase 4+)

以下内容为**未来规划**，不在 MVP 范围内：

#### 7.2.1 云端托管版

**目标用户**: 不想配置 API Key 的非技术用户

**服务内容**:
- 提供预配置的云端服务
- 积分充值系统
- 统一模型调用管理
- 云端存储和同步

#### 7.2.2 积分系统设计（规划中）

> **重要说明**: 以下积分/充值/订阅功能为 **Phase 4+ 规划**，MVP 阶段（Phase 1-3）仅采用 BYOK 模式，不实现任何支付/充值/订阅功能。

**积分 (Credits)** 是平台内部的计量单位，用于消耗 AI 模型服务。

| 积分 | 美元价值 | 购买价格 |
|------|----------|----------|
| 1 积分 | ≈ $0.012 | 按套餐不同 |

**模型消耗定价（预估）**:

**图像生成模型**（以生成一张图为单位）:

| 模型 | 积分消耗 | 失败退款 |
|------|----------|----------|
| Stable Diffusion 3.5 | 10积分 | ✅ |
| Flux Pro/Redux | 20积分 | ✅ |
| Midjourney V6 | 30积分 | ✅ |
| GPT Image 1.5 | 25积分 | ✅ |
| Nano Banana | 15积分 | ✅ |
| Recraft V3 | 20积分 | ✅ |

**视频生成模型**（以 5 秒视频为单位）:

| 模型 | 5s | 10s | 15s | 超出部分 | 失败退款 |
|------|-----|-----|-----|----------|----------|
| Kling 2.1 | 50 | 100 | 150 | 每 5s +50 | ✅ |
| Sora 2 | 80 | 160 | 240 | 每 5s +80 | ✅ |
| Runway Gen-3 | 70 | 140 | 210 | 每 5s +70 | ✅ |
| Pika Labs | 40 | - | - | - | ✅ |
| Luma Dream Machine | 60 | - | - | - | ✅ |
| Hailuo 2.3 | 45 | 90 | - | 每 5s +45 | ✅ |
| Google Veo 3 | 65 | - | - | - | ✅ |

**视频时长折算规则**:
- 基础单位: 5 秒
- 超出部分: 按 5 秒为单位向上取整（如 7s 按 10s 计费）
- 不同模型支持的最大时长见模型列表

**分辨率加成**:

| 分辨率 | 加成比例 |
|--------|----------|
| 720p | 基准 (1x) |
| 1080p | +20% |
| 4K | +100% |

**对话模型**（以 1K tokens 为单位）:

| 模型 | 积分消耗 | 失败退款 |
|------|----------|----------|
| GPT-4o | 1积分/1K tokens | ✅ |
| Claude 4 | 1.5积分/1K tokens | ✅ |
| DeepSeek V3 | 0.2积分/1K tokens | ✅ |
| Gemini 2.5 Pro | 0.8积分/1K tokens | ✅ |

#### 7.2.3 超额/欠费处理

| 场景 | 处理方式 |
|------|----------|
| 积分不足 | 任务排队，提示充值，充值后自动继续 |
| 生成失败 | 全额退款，支持重试 |
| 部分成功（批量） | 成功部分扣费，失败部分退款 |
| 长时间未使用 | 积分到期前 30 天邮件提醒 |

#### 7.2.4 退款/对账

**退款政策**:
- 未使用积分: 购买 30 天内可全额退款
- 已使用积分: 不支持退款
- 异常扣费: 7 天内支持申诉退款

**对账单据**:
- 每月 3 号生成月度账单
- 支持 CSV/PDF 导出
- 记录每次消耗的模型、时间、积分、结果

#### 7.2.5 充值套餐设计

| 套餐 | 价格 | 积分 | 赠送 | 实际单价 | 适合人群 |
|------|------|------|------|----------|----------|
| Starter | $4.99 | 100 | - | $0.050/积分 | 体验用户 |
| Basic | $19 | 500 | 50 | $0.035/积分 | 个人创作者 |
| Pro | $39 | 1200 | 300 | $0.026/积分 | 专业创作者 |
| Studio | $79 | 3000 | 800 | $0.021/积分 | 小型团队 |
| Team | $149 | 8000 | 3000 | $0.014/积分 | 制作公司 |
| Annual | $499 | 40000 | 12000 | $0.010/积分 | 重度用户 |

### 7.3 收入来源 (Phase 4+)

> **重要说明**: 以下收入来源为 **Phase 4+ 商业化规划**，MVP 阶段（Phase 1-3）采用 BYOK 模式，无平台收入。

| 收入类型 | 说明 |
|----------|------|
| **积分充值** | 主要收入来源 |
| **企业订阅** | 按席位/用量计费 |
| **工作流市场** | 优质工作流分成（创作者收益 30%） |
| **API 调用** | 开放 API 调用计费 |
| **私有部署** | 企业版授权费 |
| **培训服务** | 企业培训、定制开发 |

### 7.4 成本结构 (Phase 4+)

> **重要说明**: 以下成本结构为 **Phase 4+ 商业化规划**，MVP 阶段（Phase 1-3）采用 BYOK 模式，平台无运营成本。

| 成本项 | 说明 |
|--------|------|
| **API 成本** | 各模型 API 调用费用（约占总收入的 40-50%）|
| **服务器成本** | 云端服务器、CDN、存储 |
| **运营成本** | 客服、社区运营、市场推广 |
| **研发成本** | 持续产品迭代 |

### 7.5 定价策略 (Phase 4+)

> **重要说明**: 以下定价策略为 **Phase 4+ 商业化规划**，MVP 阶段（Phase 1-3）采用 BYOK 模式，用户自行承担 API 成本。

**价格锚定**:
- 对标同类产品（Runway、Midjourney 等）
- 提供更具竞争力的性价比

**差异化定价**:
- 高频用户推出积分包折扣
- 长视频按秒计费（超出 5s 部分）
- 批量生成提供批量折扣

**动态定价**:
- 根据模型 API 成本波动调整
- 节假日/特殊活动限时优惠

---

## 8. 竞争分析

### 行业领先产品A
**优势**:
- 工作流科学，节点式操作直观
- 专业级TVC广告制作能力
- 强大的分镜头解析功能

**可借鉴**:
- 节点式编辑器的交互设计
- 一键拉片功能
- Agent Workflow概念

### 行业领先产品B
**优势**:
- 三段式创作理念清晰（Ideate → Iterate → Scale）
- 50+模型集成，统一订阅
- 团队协作和规模化能力强

**可借鉴**:
- 创作阶段的划分
- 工作流可复用性
- 品牌一致性工具

### Firebringer 的差异化定位
1. **单机桌面版 (Desktop-Only)**: Wails 桌面应用，本地优先，保护隐私
2. **可控性优先**: 面向专业创作者的 AI 控制台，而非黑盒生成工具
3. **BYOK 模式**: 用户自带 API Key，零平台费用，完全透明
4. **心流体验**: 无限画布设计，让创作者进入沉浸式创作状态
5. **开源生态**: 提供开源版本，吸引开发者社区
6. **本地优先**: 本地计算降低成本，支持离线编辑（生成需联网）
7. **未来社区驱动**: 工作流市场 + 创作者社区 (Phase 4)

---

## 9. 风险与挑战

> **说明**: 本章节列出的"责任人"为开源团队（2人）。商业风险（API 成本、竞争、合规）主要适用于 Phase 4 商业化后。

### 9.1 技术风险

#### AI模型稳定性
**风险描述**: 第三方API可能不稳定、限流、下线

**缓解措施**:
| 措施 | 实现方式 | 责任人 | 监控指标 |
|------|----------|--------|----------|
| 多模型备份 | 每个功能配置2-3个备用模型 | 开源团队 | 主模型故障切换率 < 5分钟 |
| 降级策略 | API失败时自动降级到备用模型 | 开源团队 | 降级成功率 > 95% |
| 健康检查 | 每30秒ping一次API端点 | 开源团队 | 健康检查覆盖率 100% |
| 熔断机制 | 连续失败10次触发熔断，1分钟后恢复 | 开源团队 | 熔断响应时间 < 1秒 |

**监控指标**:
- API成功率 (目标: > 99%)
- API响应时间 (目标: P95 < 3s)
- 降级触发次数 (目标: < 0.1%请求)

#### 视频生成速度
**风险描述**: 生成耗时长（30s-5分钟），用户体验差

**缓解措施**:
| 措施 | 实现方式 | 责任人 | 监控指标 |
|------|----------|--------|----------|
| 异步任务队列 | 本地任务队列（JS Promise） | 开源团队 | 任务成功率 > 95% |
| 进度展示 | 轮询 API 状态更新进度 | 开源团队 | 进度更新频率 1Hz |
| 后台通知 | 生成完成后桌面通知 | 开源团队 | 通知到达率 > 95% |

> **注**: Redis 队列、WebSocket 推送、优先级队列为 Phase 4 优化项，MVP 采用简化实现

**监控指标**:
- 平均生成时间 (目标: 5s视频 < 90s)
- 任务超时率 (目标: < 1%)
- 用户放弃率 (目标: < 5%)

### 9.2 商业风险

> **注**: 以下商业风险主要适用于 Phase 4 商业化后。MVP 阶段采用 BYOK 模式，用户自行承担 API 成本，平台无运营成本。

#### API成本控制
**风险描述**: 高频调用可能导致成本超出收入

**缓解措施**:
| 措施 | 实现方式 | 责任人 | 监控指标 |
|------|----------|--------|----------|
| 分层定价 | 按用户等级设置速率限制 | 开源团队 | 免费用户成本 < $0.05/用户 |
| 成本监控 | 实时统计API调用成本 | 开源团队 | 日成本异常告警阈值 ±20% |
| 缓存优化 | 相同请求24小时内返回缓存 | 开源团队 | 缓存命中率 > 30% |
| 本地模型 | 支持用户接入本地模型 | 开源团队 | 本地模型使用率 > 10% |

**监控指标**:
- 单用户平均成本 (目标: < 收入的50%)
- 毛利率 (目标: > 40%)
- 积分消耗异常用户 (目标: 自动封禁阈值 1000积分/天)

#### 竞争压力
**风险描述**: 市场已有Runway、FloraFauna等成熟竞品

**缓解措施**:
| 措施 | 实现方式 | 责任人 | 监控指标 |
|------|----------|--------|----------|
| 开源差异化 | 核心功能开源，吸引开发者社区 | 开源团队 | GitHub Stars > 1000 |
| 本地优先 | Wails桌面应用，支持离线 | 开源团队 | 离线使用率 > 30% |
| 价格优势 | 积分定价低于竞品30% | 开源团队 | 价格竞争力评分 |
| 社区驱动 | 工作流市场、创作者激励 | 开源团队 | 活跃创作者数 |

**监控指标**:
- 月活用户增长率 (目标: > 20% MoM)
- 付费转化率 (目标: > 5%)
- 用户留存率 (目标: D7 > 30%)

### 9.3 法律与合规风险

#### 版权问题
**风险描述**: AI生成内容的版权归属不明确

**缓解措施**:
| 措施 | 实现方式 | 责任人 | 监控指标 |
|------|----------|--------|----------|
| 用户协议 | 明确生成内容版权归用户 | 开源团队 | 协议签署率 100% |
| 内容审核 | 自动检测侵权内容 | 开源团队 | 违规内容拦截率 > 95% |
| DMCA流程 | 建立侵权投诉处理流程 | 开源团队 | 投诉响应时间 < 24小时 |
| 生成水印 | 所有生成内容添加隐形水印 | 开源团队 | 水印覆盖率 100% |

**监控指标**:
- 版权投诉次数 (目标: < 1/10000生成)
- 投诉处理时效 (目标: 平均 < 48小时)

### 9.4 风险响应级别

| 级别 | 描述 | 响应时间 | 升级条件 |
|------|------|----------|----------|
| P1-严重 | 核心服务不可用 | 15分钟 | 立即升级到CTO |
| P2-高 | 主要功能受影响 | 1小时 | 4小时未解决升级 |
| P3-中 | 部分用户受影响 | 4小时 | 24小时未解决升级 |
| P4-低 | 轻微问题 | 24小时 | 按正常排期处理 |

---

## 10. 附录：功能优先级矩阵

### 10.1 完整功能优先级矩阵

| 功能模块 | 优先级 | 开发周期 | 核心度 |
|---------|--------|----------|--------|
| **Phase 1: MVP (4周)** |
| 无限画布编辑器 | P0 | 2周 | ⭐⭐⭐⭐⭐ |
| 节点系统（基础） | P0 | 2周 | ⭐⭐⭐⭐⭐ |
| 本地存储系统 | P0 | 1周 | ⭐⭐⭐⭐⭐ |
| AI模型集成(BYOK, 1-2个) | P0 | 2周 | ⭐⭐⭐⭐⭐ |
| API Key配置管理 | P0 | 1周 | ⭐⭐⭐⭐⭐ |
| 基础项目管理 | P0 | 1周 | ⭐⭐⭐⭐ |
| 历史记录系统 | P1 | 1周 | ⭐⭐⭐⭐ |
| **Phase 2: 核心功能 (6周)** |
| 提示词库系统 | P1 | 2周 | ⭐⭐⭐⭐⭐ |
| 角色库系统 | P1 | 2周 | ⭐⭐⭐⭐⭐ |
| 关键帧提取 | P1 | 1周 | ⭐⭐⭐⭐ |
| 蒙版编辑器 | P1 | 1周 | ⭐⭐⭐⭐ |
| 九宫格分镜表 | P1 | 2周 | ⭐⭐⭐⭐⭐ |
| 更多AI模型集成 | P1 | 4周 | ⭐⭐⭐⭐⭐ |
| 预设工作流 | P1 | 2周 | ⭐⭐⭐⭐ |
| **Phase 3: 高级功能 (8周)** |
| 视频分析节点 | P1 | 1周 | ⭐⭐⭐⭐ |
| 首尾帧视频生成 | P1 | 1周 | ⭐⭐⭐⭐ |
| Midjourney网格处理 | P1 | 1周 | ⭐⭐⭐⭐ |
| 图像对比节点 | P1 | 1周 | ⭐⭐⭐⭐ |
| 预览窗口 | P1 | 1周 | ⭐⭐⭐⭐ |
| 高级编辑工具 | P1 | 4周 | ⭐⭐⭐⭐ |
| 批量生成 | P1 | 2周 | ⭐⭐⭐⭐ |
| 媒体库管理 | P1 | 2周 | ⭐⭐⭐ |
| 本地文件管理 | P1 | 2周 | ⭐⭐⭐⭐ |
| 缓存管理系统 | P1 | 1周 | ⭐⭐⭐⭐ |
| 对话侧栏增强 | P1 | 2周 | ⭐⭐⭐⭐ |
| 性能模式优化 | P1 | 1周 | ⭐⭐⭐⭐ |
| 虚拟列表优化 | P1 | 1周 | ⭐⭐⭐⭐ |
| **Phase 4: 商业化与协作 (未来规划)** |
| 团队协作 | P2 | 6周+ | ⭐⭐⭐ |
| 版本管理 | P2 | 2周 | ⭐⭐⭐ |
| 实时协作 | P2 | 8周+ | ⭐⭐ |
| 工作流市场 | P2 | 6周+ | ⭐⭐⭐ |
| 作品分享社区 | P2 | 8周+ | ⭐⭐⭐ |
| 积分充值系统 | P2 | 4周+ | ⭐⭐⭐ |
| 付费订阅模式 | P2 | 持续 | ⭐⭐⭐ |
| 云端同步 | P2 | 4周+ | ⭐⭐⭐ |
| 插件系统 | P2 | 6周+ | ⭐⭐ |
| API开放平台 | P2 | 4周+ | ⭐⭐ |

### 10.2 行业标准功能覆盖对照

| 行业标准功能 | Firebringer规划状态 | 说明 |
|-------------|---------------------|------|
| 视频输入节点+关键帧 | ✅ 2.10节 | 完整规划 |
| 视频分析节点 | ✅ 2.13节 | 完整规划 |
| 图像输入节点 | ✅ 节点类型列表 | 基础功能 |
| 分镜节点 | ✅ 2.3节 + 节点列表 | 增强版 |
| 提示词库 | ✅ 2.8节 | 新增 |
| 角色库系统 | ✅ 2.9节 | 新增 |
| 蒙版编辑器 | ✅ 2.11节 | 新增 |
| 历史记录+虚拟列表 | ✅ 2.14节 | 新增 |
| Midjourney网格处理 | ✅ 2.11节 | 新增 |
| 首尾帧视频生成 | ✅ 2.12节 | 新增 |
| 本地存储系统 | ✅ 2.14节 | 新增 |
| 性能模式 | ✅ 4.4节 | 完整设计 |
| 本地文件管理 | ✅ 4.5节 | Wails Bindings |
| 对话侧栏 | ✅ 4.6节 | 完整设计 |
| 虚拟列表 | ✅ 4.4.2节 | 完整设计 |
| 主题切换 | ✅ UI设计原则 | 已有 |

### 10.3 Firebringer 独有功能

| 功能 | 优势 | 阶段 |
|------|------|------|
| 三段式创作流程 | 理念差异化 | MVP |
| Wails 桌面应用 | 本地计算、离线编辑（生成需联网） | MVP |
| 团队协作 | 企业客户需求 | Phase 4 |
| 工作流市场 | 商业化路径 | Phase 4 |
| 开源生态 | 开发者社区 | MVP |

---

## 11. 更新日志

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v2.3 | 2026-01-02 | **终极无歧义版**：第 7 章积分/充值/订阅/成本/定价全部显式标注 Phase 4+；模型分类表标注"路线图规划"；风险表 TBD 替换为"开源团队"；确认无"本地保存服务"残留 |
| v2.2 | 2026-01-02 | **正式版**：明确首发 3 模型（GPT-4o + Nano Banana + Veo 3），修改"本地保存服务"为"本地文件管理"，商业风险标注 Phase 4 适用，风险表简化 MVP 实现 |
| v2.1 | 2026-01-02 | **终极版**：修正 "即时反馈" 与异步进度矛盾；统一存储架构（移除 IndexedDB/Web fallback）；补充输出规格（分辨率、比例、文件上限）；架构图添加离线/在线能力说明；标注协作/市场功能为 Phase 4；添加风险责任人说明 |
| v2.0 | 2026-01-02 | **单机桌面版重大重构**：明确 Desktop-Only 架构，移除所有 Web 版本规划；采用 BYOK 模式，积分系统移至 Phase 4；协作/市场功能移至 Phase 4；添加详细时间线（4周/6周/8周）；修正技术承诺（"实时"→"异步"，"同步"→"本地"）|
| v1.5 | 2026-01-02 | 根据代码审查反馈完善：架构拓扑、模型路线图、本地保存服务细节、积分系统定义、协作角色权限、工作流市场结算审核、分镜规格、风险监控指标 |
| v1.4 | 2026-01-02 | 全球市场重新定位，聚焦 TVC/影视创作者，强调可控性和心流体验，USD 定价 |
| v1.3 | 2026-01-02 | 新增商业模式完整设计（双轨制策略、积分系统、定价策略） |
| v1.2 | 2026-01-02 | 新增用户场景、10+ 节点类型、性能优化、本地保存服务、对话侧栏设计 |
| v1.1 | 2026-01-02 | 新增提示词库、角色库、关键帧提取等功能模块 |
| v1.0 | 2026-01-02 | 初始版本，基础 PRD 框架 |

---

## 12. 下一步行动

1. **评审PRD**: 团队讨论，确认优先级
2. **技术预研**: AI模型接入方案调研
3. **UI/UX设计**: 设计画布编辑器的详细交互
4. **开始开发**: Phase 1 MVP启动

---

**文档维护**: 本PRD将随产品演进持续更新
**问题反馈**: 请在项目Issue中提出
